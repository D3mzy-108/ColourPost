{% extends 'manufacturer_site/dashboard_layout.html' %}
{% load custom_template_filters %}
{% load static %}

{% block title %}
Dashboard
{% endblock title %}

{% block head %}
<script src="{% static 'js/apexcharts.min.js' %}"></script>
{% endblock head %}

{% block content %}
<div class="w-full relative flex flex-col gap-12">

    <!-- Raw Materials Management -->
    <section class="w-full">
        {% include './components/filters.html' %}
        {% include './components/summary_section.html' %}
    </section>

    <!-- Production Metrics -->
    <section class="w-full px-2 sm:px-4">
        <div class="w-full py-3">
            <div class="w-full p-2 backdrop-blur-md rounded-xl bg-white/10 flex gap-4 items-center">
                <div class="flex-1 border-y"></div>
                <legend class="text-md font-medium uppercase">Live Environments</legend>
                <div class="flex-1 border-y"></div>
            </div>
        </div>
        {% include './components/live_production_section.html' %}
    </section>

    <!-- Inventory Metrics -->
    <section class="w-full px-2 sm:px-4">
        {% include './components/low_stock_section.html' %}
    </section>

    <!-- Inventory Management -->
    <section class="w-full">
        <div class="w-full py-3">
            <div class="w-full p-2 backdrop-blur-md rounded-xl bg-white/10 flex gap-4 items-center">
                <div class="flex-1 border-y"></div>
                <legend class="text-md font-medium uppercase">Production Cost Analysis</legend>
                <div class="flex-1 border-y"></div>
            </div>
        </div>
        <div class="w-full p-3 rounded-xl bg-[#65B5A320]">
            <div class="w-full" id="productionCostOverTime"></div>
        </div>
    </section>

    <!-- Sales Metrics -->
    <!-- <section class="w-full">
        <div class="w-full sticky top-0 py-3">
            <div class="w-full py-3 px-4 backdrop-blur-md rounded-xl bg-white/10">
                <legend class="text-md font-medium">Sales Metrics</legend>
            </div>
        </div>
    </section> -->

    <!-- Financial Metrics -->
    <!-- <section class="w-full">
        <div class="w-full sticky top-0 py-3">
            <div class="w-full py-3 px-4 backdrop-blur-md rounded-xl bg-white/10">
                <legend class="text-md font-medium">Financial Metrics</legend>
            </div>
        </div>
    </section> -->

    <!-- Expense Tracking -->
    <!-- <section class="w-full">
        <div class="w-full sticky top-0 py-3">
            <div class="w-full py-3 px-4 backdrop-blur-md rounded-xl bg-white/10">
                <legend class="text-md font-medium">Expense Tracking</legend>
            </div>
        </div>
    </section> -->

    <!-- Performance Indicators -->
    <!-- <section class="w-full">
        <div class="w-full sticky top-0 py-3">
            <div class="w-full py-3 px-4 backdrop-blur-md rounded-xl bg-white/10">
                <legend class="text-md font-medium">Performance Indicators</legend>
            </div>
        </div>
    </section> -->
</div>
{% endblock content %}

{% block scripts %}
<script>
    var productionCostOverTime = JSON.parse('{{production_cost_over_time|safe}}');
    new ApexCharts(document.querySelector("#productionCostOverTime"), {
        chart: {
            type: 'area',
            height: '350',
        },
        series: [
            {
                type: 'area',
                data: productionCostOverTime.y,
            },
        ],
        xaxis: {
            type: 'datetime',
            categories: productionCostOverTime.x
        },
        legend: {
            show: true,
            position: 'top',
            horizontalAlign: 'left',
        },
        title: {
            text: '',
            margin: 20,
            style: {
                fontWeight: '600',
                fontSize: '16',
            },
        },
        stroke: {
            curve: 'smooth',
            width: 2,
        },
        dataLabels: {
            enabled: false,
        },
        yaxis: {
            show: true,
            labels: {
                formatter: function (value) {
                    return Math.floor(value);
                }
            },
        },
        grid: {
            show: false,
        },
    }).render();
</script>
{% endblock scripts %}